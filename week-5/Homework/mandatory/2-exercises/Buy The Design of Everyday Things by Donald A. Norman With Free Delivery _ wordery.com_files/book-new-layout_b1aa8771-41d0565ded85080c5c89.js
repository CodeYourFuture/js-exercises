(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"2XLN":function(e,t,n){"use strict";var r=n("J4zp"),a=n.n(r),i=n("cDf5"),o=n.n(i),s=n("o0o1"),c=n.n(s),u=n("lwsE"),l=n.n(u),d=n("W8MJ"),h=n.n(d),f=n("lSNA"),p=n.n(f);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l()(this,e),p()(this,"_successHandler",void 0),p()(this,"_errorHandler",void 0),p()(this,"_alwaysHandler",void 0),p()(this,"_isComplete",!1),p()(this,"_request",void 0),p()(this,"_response",void 0),p()(this,"_error",void 0),p()(this,"_data",void 0),p()(this,"url",void 0),p()(this,"options",void 0),p()(this,"_fetchOptions",void 0),p()(this,"_makeRequest",(function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n._isComplete){e.next=2;break}throw new Error("Dont call _makeRequest twice.");case 2:return e.prev=2,n._request=fetch(n.url,n._fetchOptions),e.next=6,c.a.awrap(n._request);case 6:if(n._response=e.sent,200!==n._response.status){e.next=13;break}return e.next=10,c.a.awrap(n._response[n._dataType]());case 10:n._data=e.sent,e.next=14;break;case 13:n._error=new Error("Response status ".concat(n._response.status));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),n._error=e.t0;case 19:if(n._isComplete=!0,n._error?n._errorHandler&&n._errorHandler(n._error,n._response,n):n._successHandler&&n._successHandler(n._data,n._response,n),!n._alwaysHandler){e.next=23;break}return e.abrupt("return",n._alwaysHandler(n));case 23:if(!n._error||n._errorHandler){e.next=25;break}throw n._error;case 25:case"end":return e.stop()}}),null,null,[[2,16]])})),!t)throw new Error("url is required");this.url=t,this.options=v({},e.defaultOptions,{},r),this._dataType=this.options.dataType,this._fetchOptions=e._createFetchOptions(this.options),this._makeRequest()}return h()(e,[{key:"getData",value:function(){return this._data}},{key:"getError",value:function(){return this._error}},{key:"getResponse",value:function(){return this._response}},{key:"success",value:function(e){var t=this;return this._successHandler=e,this._isComplete&&this._data&&requestAnimationFrame((function(){return t._successHandler(t._data,t._response,t)})),this}},{key:"error",value:function(e){var t=this;return this._errorHandler=e,this._isComplete&&this._error&&requestAnimationFrame((function(){return t._errorHandler(t._error,t._response,t)})),this}},{key:"always",value:function(e){var t=this;return this._alwaysHandler=e,this._isComplete&&requestAnimationFrame((function(){return t._alwaysHandler(t)})),this}}],[{key:"_createFetchOptions",value:function(t){var n=v({},t),r=t.dataType;if(delete n.dataType,n.headers=v({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},n.headers),"json"===r&&(n.headers=v({},n.headers,{Accept:"application/json, text/javascript, */*; q=0.01"})),n.jwt&&(n.headers["wrdry-jwt"]=n.jwt,delete n.jwt),n.data){if("object"===o()(n.data)){for(var i=e.flattenObject(n.data),s="",c=0,u=Object.entries(i);c<u.length;c++){var l=a()(u[c],2),d=l[0],h=l[1];s+="&".concat(encodeURIComponent(d),"=").concat(encodeURIComponent(h))}s&&(n.body=s.replace(/^\&/,""))}else n.body=n.data;delete n.data}return n}},{key:"flattenObject",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.entries(t).reduce((function(t,r){var i=a()(r,2),s=i[0],c=i[1];return s=n?"".concat(n,"[").concat(s,"]"):s,"object"===o()(c)?t=v({},t,{},e.flattenObject(c,s,t)):t[s]=c,t}),r)}}]),e}();p()(_,"defaultOptions",{method:"GET",credentials:"same-origin",dataType:"json"}),n.d(t,"a",(function(){return b}));var y=function(e,t){return new _(e,t)},b=(t.b=y,function(e,t){return new Promise((function(n,r){return y(e,t).success(n).error(r)}))})},"5v7H":function(e,t,n){"use strict";t.a=Object.assign||function(e,t){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var n=Object(e),r=Object.prototype.hasOwnProperty,a=1;a<arguments.length;a++){var i=arguments[a];if(null!=i){var o=Object(i);for(var s in o)r.call(o,s)&&(n[s]=o[s])}}return n}},"7iNS":function(e,t,n){"use strict";function r(e,t,n,r){return t?function(){var i=r||this,o=arguments,s=function(){a=null,n||e.apply(i,o)},c=n&&!a;clearTimeout(a),a=setTimeout(s,t),c&&e.apply(i,o)}:e;var a}function a(e,t,n,r){var a,i=null;return function(){r=r||this,a=arguments,n&&!i&&e.apply(r,a),i||(i=setTimeout((function(){n||e.apply(r,a),i=null}),t))}}function i(e,t,n){var r,a=!1;return function(){r=arguments,n=n||this,t&&!a&&e.apply(n,r),a||(a=!0,requestAnimationFrame((function(){e.apply(n,r),a=!1})))}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},HTjc:function(e,t,n){"use strict";n.r(t);var r,a=n("XMGv"),i=n("uqmy"),o=n("r6zU"),s=n("q1tI"),c=n.n(s),u=n("W0zr"),l=n("CnBM"),d=n.n(l)()({loader:function(){return n.e(26).then(n.bind(null,"j1Jd"))},loading:function(){return c.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",textAlign:"center"}},c.a.createElement("i",{className:"o-i o-i--xxl o-i--spinner o-i--spin"}),c.a.createElement("br",null),"Loading...")}});u.a.addPreLightboxBind("#gallery",(function(){d.preload()})),u.a.bindToLightbox("#gallery",(function(e){var t,n;e.options.children=c.a.createElement(d,(t=e.options.node,n={},t.hasAttribute("data-image")&&(n.image=t.getAttribute("data-image")),t.hasAttribute("data-images")&&(n.images=JSON.parse(t.getAttribute("data-images")),n.initialIndex=r),n)),e.options.expand=!0,e.options.node=null})),document.querySelectorAll(".js-prod-gallery-trigger").forEach((function(e){e.addEventListener("click",(function(){if(e.hasAttribute("data-selector-index")){var t=parseInt(e.getAttribute("data-selector-index"),10);r=isNaN(t)?void 0:t}else r=void 0}))}));var h=n("lwsE"),f=n.n(h),p=n("W8MJ"),m=n.n(p),v=n("lSNA"),_=n.n(v),y=function(){function e(t,n,r){var i=this;f()(this,e),_()(this,"evaluate",(function(){var e=i.wrapper.getBoundingClientRect().height<i.calculateListHeight();i.wrapper.classList.toggle("c-prod-img--pnav",e),e?i._addListeners():i._removeListeners()})),_()(this,"progress",(function(){var e=i.getNextPosition();try{i.list.scrollTo({top:e,left:0,behavior:"smooth"})}catch(t){window.scrollTo(0,e)}})),this.wrapper=t,this.list=n,this.pnav=r,this.evaluate(),a.a.addListener(this.evaluate)}return m()(e,[{key:"calculateListHeight",value:function(){return this.list.children.length*(e.LIST_ITEM_HEIGHT+e.LIST_ITEM_GAP)-e.LIST_ITEM_GAP}},{key:"_addListeners",value:function(){this.pnav.addEventListener("click",this.progress)}},{key:"_removeListeners",value:function(){this.pnav.removeEventListener("click",this.progress)}},{key:"getNextPosition",value:function(){var t=this.wrapper.getBoundingClientRect().height;if(this.list.scrollTop>=this.list.scrollHeight-Math.floor(t))return 0;for(var n=e.LIST_ITEM_HEIGHT+e.LIST_ITEM_GAP,r=this.list.children.length;this.list.scrollTop<r*n;)r--;return(r+1)*n}}]),e}();_()(y,"LIST_ITEM_HEIGHT",60),_()(y,"LIST_ITEM_GAP",20),function(){var e=document.querySelector(".js-thumb-wrapper");if(e){var t=e.querySelector(".js-thumb-list"),n=e.querySelector(".js-thumb-pnav");t&&n&&new y(e,t,n)}}();var b,g,w,E,k=n("uaZG"),T=n("mmso"),O=n("vByC"),L=n("2XLN"),S=function(e){i.a.dispatch(O.b.Actions.UPDATE,{alternatives:e})},N=function(e){Object(L.b)(O.b.Routes.ALT_FORMATS+"/"+e).success((function(e){S(e)})).error((function(){S(null)}))},x={setIsbn13:function(e){return i.a.dispatch(O.b.Actions.UPDATE,{isbn13:e}),this},getAltFormats:function(){return N(T.a.getData().isbn13),this}},j=!0,D=window.location.pathname.match(/[\d]{13}$/);function A(e){if(!e)throw new Error("expected currentId and got "+e);if(!/^#/.test(e))throw new Error('currentId should be an id starting with a "#"');var t=document.querySelector('.js-tab[href="'+e+'"]');if(t){var n=document.querySelectorAll('.js-tab[data-tab-group="'+t.getAttribute("data-tab-group")+'"]');Array.from(n).forEach((function(e){e.classList.remove("is-active"),document.querySelector(e.hash).classList.add("is-hidden")})),t.classList.add("is-active"),document.querySelector(t.hash).classList.remove("is-hidden")}else!function(e){if(!e)throw new Error("expected currentId and got "+e);if(!/^#/.test(e))throw new Error('currentId should be an id starting with a "#"');var t=document.querySelector(e);if(t){var n=Object(k.a)(t,".js-tab-panel");n&&n.id&&A("#"+n.id)}}(e)}function P(e){a.a.isMobile()?function(e){if(!e)throw new Error("expected id and got "+e);var t=document.getElementById(e);if(t){var n=Object(k.a)(t,".o-expand");n&&n.classList.remove("is-hidden")}}(e.replace(/^#/,"")):A(e)}!function(){try{b=n("q1tI"),g=n("i8i4"),w=n("RlR/").default,E=n("JW/G").default}catch(e){console.error(e),j=!1}}(),D&&D.length&&x.setIsbn13(D[0]).getAltFormats(),window.addEventListener("hashchange",(function(e){if(location.hash){var t=document.querySelector(location.hash);P(location.hash),t&&t.scrollIntoView()}})),window.addEventListener("click",(function(e){if(e.target.matches(".js-tab"))return e.preventDefault(),void A(e.target.hash);if(e.target.matches(".js-read-blurb"))if(e.preventDefault(),a.a.isMobile()){var t=document.querySelector(".js-details-expand");t&&("function"==typeof t.click?t.querySelector('[data-action="expand"]').click():t.classList.remove("is-hidden"),t.scrollIntoView())}else{var n=document.querySelector(".js-details-tab");n&&(A("#"+n.id),n.scrollIntoView())}}),!0),i.a.once(o.c.Actions.DOM_CONTENT_LOADED,(function(){a.a.addListener((function(e){if(e.isMobile!==e.lastState.isMobile&&!e.isMobile){var t,n=Array.from(document.querySelectorAll(".c-prod-tab-panels .o-expand"));if(n.length&&n.forEach((function(e){t||e.matches(".is-hidden")||!e.id||(t=e.id)})),!t)if(n[0].id)t=n[0].id;else{if(!document.querySelector(".js-tab[href]"))return;t=document.querySelector(".js-tab[href]").href.replace(/^#/,"")}A("#"+t)}})),location.hash&&P(location.hash),j&&(document.querySelector(".js-altf-nav-link")&&g.render(b.createElement(w,null),document.querySelector(".js-altf-nav-link")),document.querySelector(".js-altf")&&g.render(b.createElement(E,null),document.querySelector(".js-altf"))),document.querySelector(".js-look-inside")&&n.e(67).then(n.bind(null,"qkwn"))}))},"JW/G":function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),i=n("lwsE"),o=n.n(i),s=n("W8MJ"),c=n.n(s),u=n("a1gu"),l=n.n(u),d=n("Nsbk"),h=n.n(d),f=n("PJYZ"),p=n.n(f),m=n("7W2i"),v=n.n(m),_=n("lSNA"),y=n.n(_),b=n("17x9"),g=n.n(b),w=n("XMGv"),E=n("i8i4"),k=n.n(E),T=0,O=function(e){function t(){var e,n;o()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=l()(this,(e=h()(t)).call.apply(e,[this].concat(a))),y()(p()(n),"state",{isEnabled:!1}),y()(p()(n),"_checkEnabled",(function(){var e=p()(n);requestAnimationFrame((function(){var t=e.refs.inner.children[0].getBoundingClientRect().width,n=e.refs.outer.getBoundingClientRect().width;console.log("setEnabled",t>n),e.setState({isEnabled:t>n})}))})),y()(p()(n),"_resetCache",(function(){n._cache={isDragging:!1,currentTransform:0,currentMousePos:0,lastMousePos:0,boundMax:0,boundMin:-200}})),y()(p()(n),"_renderFrame",(function(e){var t=n.props.minVelocity,r=n._cache;n.state.isEnabled&&e===n._cache.dragId&&(r.isDragging?(r.velocity=r.currentMousePos-r.lastMousePos,(r.currentTransform+r.velocity>r.boundMax||r.currentTransform+r.velocity<r.boundMin)&&(r.velocity=0)):(r.velocity*=n.props.friction,r.currentMousePos=r.lastMousePos+r.velocity,(r.currentTransform+r.velocity>r.boundMax||r.currentTransform+r.velocity<r.boundMin)&&(r.velocity=-r.velocity*n.props.bounce)),r.currentTransform+=r.velocity,r.lastMousePos=r.currentMousePos,n.refs.inner.style.transform="translateX("+r.currentTransform+"px)",r.isDragging&&"block"!==n.refs.mask.style.display&&(r.velocity>n.props.deadzone||r.velocity<-n.props.deadzone)&&(n.refs.mask.style.display="block"),(r.isDragging||r.velocity>t||r.velocity<-t)&&requestAnimationFrame(n._renderFrame.bind(p()(n),e)))})),y()(p()(n),"_getEvents",(function(e){return e.type.match("mouse")?{move:"mousemove",up:"mouseup"}:{move:"touchmove",up:"touchend"}})),y()(p()(n),"_mouseMove",(function(e){var t=e.touches?e.touches[0]:e;e.preventDefault(),n._cache.currentMousePos=t.clientX})),y()(p()(n),"_mouseUp",(function(e){var t=n._getEvents(e);n._cache.isDragging=!1,n.refs.mask.style.display="none",window.removeEventListener(t.up,n._mouseUp),window.removeEventListener(t.move,n._mouseMove)})),y()(p()(n),"_mouseDown",(function(e){if(n.state.isEnabled&&!n._cache.isDragging){var t=n.refs.inner.children[0].getBoundingClientRect().width,r=n.refs.outer.getBoundingClientRect().width,a=n._getEvents(e),i=e.touches?e.touches[0]:e,o=T++;n._cache.dragId=o,n._cache.currentMousePos=i.clientX,n._cache.lastMousePos=n._cache.currentMousePos,n._cache.boundMin=-(t-r),n._cache.isDragging=!0,window.addEventListener(a.up,n._mouseUp),window.addEventListener(a.move,n._mouseMove),requestAnimationFrame(n._renderFrame.bind(p()(n),o))}})),y()(p()(n),"_cancelEvent",(function(e){n._cache.isDragging&&e.preventDefault()})),n}return v()(t,e),c()(t,[{key:"componentWillUpdate",value:function(e,t){t.isEnabled||(this.refs.inner.style.transform="")}},{key:"componentDidMount",value:function(){this._resetCache(),this._checkEnabled(),w.a.addListener(this._checkEnabled)}},{key:"componentWillUnmount",value:function(){w.a.removeListener(this._checkEnabled)}},{key:"render",value:function(){return a.a.createElement("div",{ref:"outer",style:{position:"relative",width:"100%",overflow:"hidden"},onMouseDown:this._mouseDown,onTouchStart:this._mouseDown},a.a.createElement("div",{ref:"inner"},this.props.children),a.a.createElement("div",{ref:"mask",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"none"}}))}}]),t}(a.a.Component);y()(O,"propTypes",{children:g.a.element.isRequired,onSlideEnd:g.a.func,deadzone:g.a.number,friction:g.a.number,bounce:g.a.number,minVelocity:g.a.number}),y()(O,"defaultProps",{onSlideEnd:null,deadzone:5,friction:.9,bounce:.1,minVelocity:.01});var L=O,S=function(e){function t(){var e,n;o()(this,t);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=l()(this,(e=h()(t)).call.apply(e,[this].concat(i))),y()(p()(n),"state",{contentWidth:"auto",isDisabled:!0}),y()(p()(n),"outerWrapper",a.a.createRef()),y()(p()(n),"_calcWidth",(function(){var e,t,r,i=n.props.children,o=k.a.findDOMNode(n.outerWrapper.current).getBoundingClientRect().width,s=0,c=0;a.a.Children.forEach(i,(function(n,r){switch(s+n.props.width/2<o&&(e=s+n.props.width/2,t=r),s+=n.props.width,r){case 0:c=n.props.width;break;case 1:c+=n.props.width/2}})),o>=s?n.setState({contentWidth:"auto",isDisabled:!0}):o<c?n.setState({contentWidth:s,isDisabled:!1}):(r=(o-e)/t*(a.a.Children.count(i)-1),n.setState({contentWidth:s+r,isDisabled:!1}))})),n}return v()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;requestAnimationFrame((function(){return e._calcWidth()})),w.a.addListener(this._calcWidth)}},{key:"componentWillUnmount",value:function(){w.a.removeListener(this._calcWidth)}},{key:"render",value:function(){var e={};return this.state.isDisabled||(e={display:"flex",justifyContent:"space-between",width:this.state.contentWidth,transition:"width 200ms ease"}),a.a.createElement(L,{ref:this.outerWrapper},a.a.createElement(this.props.component,{style:e,className:this.props.className},this.props.children))}}]),t}(a.a.Component);y()(S,"propTypes",{component:g.a.any,className:g.a.string}),y()(S,"defaultProps",{component:"div",className:""});var N=S,x=function(e){function t(){return o()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),c()(t,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,this.props.children)}}]),t}(a.a.Component);y()(x,"propTypes",{width:b.number.isRequired});var j=x,D=function(e){function t(){return o()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),c()(t,[{key:"_getItems",value:function(){return a.a.Children.map(this.props.children,(function(e,t){var n="c-altf-nav__item",r=a.a.createRef();return e.props.selected&&(n+=" is-active"),a.a.createElement(j,{width:140},a.a.createElement("li",{className:n,key:t,ref:r,onClick:function(e){e.target===r.current&&(e.preventDefault(),r.current.querySelector(".c-altf-nav__link").click())}},e))}))}},{key:"render",value:function(){return a.a.createElement("div",{className:"c-altf-nav"},a.a.createElement(N,{component:"ul",className:"c-altf-nav__list"},this._getItems()))}}]),t}(a.a.Component),A=function(e){function t(){var e,n;o()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=l()(this,(e=h()(t)).call.apply(e,[this].concat(a))),y()(p()(n),"_onClick",(function(e){e.persist(),e.data=n.props.format,e.name=n.props.name,n.props.onClick&&n.props.onClick(e)})),n}return v()(t,e),c()(t,[{key:"componentWillMount",value:function(){this._setMinPrice(this.props.format)}},{key:"componentWillReceiveProps",value:function(e){this._setMinPrice(e.format)}},{key:"_setMinPrice",value:function(e){var t,n=1/0;e.forEach((function(e){var r=parseFloat(e.price.replace(/[^0-9.]/g,""));n>r&&(n=r,t=e.price)})),this.setState({minPrice:t})}},{key:"render",value:function(){this.props.format.reduce((function(e,t){return!e||e>t.price?t.price:e}),null);var e=a.a.createElement("b",{className:"c-altf-nav__name"},this.props.name),n=a.a.createElement("small",{className:"c-altf-nav__text"},"(",this.props.format.length,") ",1===this.props.format.length?"at":"from"," ",this.state.minPrice),r=a.a.createElement("i",{className:"c-altf-nav__icon o-i o-i--"+t.Icons[this.props.name]});return this.props.selected?a.a.createElement("span",{className:"c-altf-nav__link"},r,e,n):a.a.createElement("a",{onClick:this._onClick,className:"c-altf-nav__link"},r,e,n)}}]),t}(a.a.Component);y()(A,"propTypes",{format:g.a.array.isRequired,name:g.a.string.isRequired,onClick:g.a.func,selected:g.a.bool}),y()(A,"Icons",{Paperback:"paperback",Hardback:"hardback","CD-Audio":"cd-audio","Multi copy pack & boxset":"multi-pack","Other Languages":"languages","Other Formats":"other-formats","Mixed media product":"mixed-media"});var P=A;function M(e){return a.a.createElement("td",{className:"c-altf-table__cell"},a.a.createElement("a",{className:"c-altf-table__inner",href:e.href},e.children||"Â "))}function C(e){return a.a.createElement("tr",{className:"c-altf-table__row",onClick:location.assign.bind(location,e.href)},e.record.map((function(t,n){return a.a.createElement(M,{key:n,href:e.href},t)})))}function q(e){var t=e.headings.map((function(t){var n,r="c-altf-table__cell c-altf-table__cell--header";return"function"===e.onSort&&(r+=" c-altf-table__cell--sortable",t===e.sort&&(n="asc"===e.sortDir?a.a.createElement("i",{className:"u-no-_ o-i o-i--chev o-i--trans o-i--180deg"}):a.a.createElement("i",{className:"u-no-_ o-i o-i--chev o-i--trans"}))),a.a.createElement("th",{className:r,key:t,onClick:"function"===e.onSort?function(n){e.onSort(t,n)}:null},t,n)})),n="c-altf-table";return 2===t.length&&(n+=" c-altf-table--fixed"),a.a.createElement("table",{className:n},a.a.createElement("thead",null,a.a.createElement("tr",null,t)),a.a.createElement("tbody",null,e.records.map((function(t,n){var r=e.formatRow(t);return a.a.createElement(C,{record:r,href:t.href,key:n})}))))}C.propTypes={record:g.a.array.isRequired,href:g.a.string.isRequired},q.propTypes={records:g.a.array.isRequired,headings:g.a.array.isRequired,formatRow:g.a.func.isRequired,onSort:g.a.func,sort:g.a.string,sortDir:g.a.oneOf(["asc","desc"])},q.defaultProps={onSort:!1,showFormats:!1};var I=q,R=function(e){function t(e){var n;o()(this,t),n=l()(this,h()(t).call(this,e)),y()(p()(n),"_onClick",(function(e){n.setState(n._getNewStateObj(e.name,e.data))})),y()(p()(n),"_onSort",(function(e){var t;(t=e===n.state.sort?{sort:n.state.sort,sortDir:"asc"===n.state.sortDir?"desc":"asc"}:{sort:e,sortDir:"asc"}).selected=n._sortData(n.state.selected,t.sort,t.sortDir),n.setState(t)})),y()(p()(n),"_formatRow",(function(e){var t=[a.a.createElement("div",{className:"o-layout o-layout--auto"},a.a.createElement("span",{className:"o-layout__item"},e.publicationDate),a.a.createElement("span",{className:"o-layout__item"},e.editionStatement))];return n.state.showLang&&t.push(e.language),n.state.showFormats&&t.push(e.format),t.push(a.a.createElement("div",{className:"o-layout o-layout--auto"},a.a.createElement("span",{className:"o-layout__item",style:{minWidth:"70px"}},e.price),e.express?a.a.createElement("span",{className:"o-layout__item"},"Eligible for ",a.a.createElement("span",{className:"c-express"},"Express Delivery")):null)),t}));var r=e.alternatives,i=Object.keys(r);return n.state=n._getNewStateObj(i[0],r[i[0]]),console.log(n.state),n}return v()(t,e),c()(t,[{key:"_getNewStateObj",value:function(e,t){var n=this.state||{},r=this.props.showFormatsOn.indexOf(e)>-1,a=["Edition"],i=n.sort||"Price",o=n.sortDir||"asc",s=t.reduce((function(e,t){return!!t.language||e}),!1);return s&&a.push("Language"),r&&a.push("Format"),a.push("Price"),{selectedName:e,selected:this._sortData(t,i,o),showFormats:r,showLang:s,headings:a,sort:i,sortDir:o}}},{key:"_sortData",value:function(e,t,n){var r;switch(t){case"Edition":r=function(e){return e.publicationDate.replace(/(\d\d)\/(\d\d)\/(\d\d\d\d)/,"$3$2$1")+" "+e.editionStatement};break;case"Language":r=function(e){return e.language};break;case"Format":r=function(e){return e.format};break;case"Price":r=function(e){return parseFloat(e.price.replace(/[^0-9.]/,""))}}return e.sort((function(e,t){return(e=r(e))===(t=r(t))?0:e>t?"asc"===n?1:-1:"desc"===n?1:-1}))}},{key:"_getNavLinks",value:function(e){var t=this;return Object.keys(this.props.alternatives).map((function(n,r){return a.a.createElement(P,{selected:e===t.props.alternatives[n],key:r,name:n,format:t.props.alternatives[n],onClick:t._onClick})}))}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(D,null,this._getNavLinks(this.state.selected)),a.a.createElement(I,{records:this.state.selected,headings:this.state.headings,sort:this.state.sort,sortDir:this.state.sortDir,formatRow:this._formatRow,onSort:this.state.selected.length>1?this._onSort:null}))}}]),t}(a.a.Component);y()(R,"propTypes",{alternatives:g.a.object.isRequired,showFormatsOn:g.a.array}),y()(R,"defaultProps",{showFormatsOn:["Other Formats"]});var B=R,H=n("T49T");function W(){var e=Object(H.a)();return e.alternatives?a.a.createElement("div",{id:"other-editions-and-formats",className:"c-panel o-expand o-expand--3cols js-tab-panel c-prod-tab-panels__panel is-hidden o-anchor-targ o-anchor-targ--flush"},a.a.createElement("h2",{className:"c-prod-title c-panel__title o-expand__switch","data-action":"expand","data-size":"784"},"Other Editions and Formats",a.a.createElement("span",{className:"o-expand__symbol c-panel__icon"})),a.a.createElement("div",{className:"c-panel__body o-expand__cont u-pl0@3cols u-pr0@3cols"},a.a.createElement(B,{alternatives:e.alternatives}))):null}n.d(t,"default",(function(){return W}))},"RlR/":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("q1tI"),a=n.n(r),i=n("T49T");function o(){return Object(i.a)().alternatives?a.a.createElement("a",{"data-tab-group":"prod-tabs",className:"c-prod-tabs__link js-tab",href:"#other-editions-and-formats"},"Other Editions and Formats"):null}},T49T:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("J4zp"),a=n.n(r),i=n("q1tI"),o=n("mmso");function s(){var e=Object(i.useState)(o.a.getData()),t=a()(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){var e=function(){return r(o.a.getData())};return o.a.bind(e),function(){return o.a.unbind(e)}})),n}},W0zr:function(e,t,n){"use strict";var r=n("o0o1"),a=n.n(r),i=n("lwsE"),o=n.n(i),s=n("W8MJ"),c=n.n(s),u=n("lSNA"),l=n.n(u),d=function(){function e(){var t=this;if(o()(this,e),l()(this,"_lightboxBinds",{}),l()(this,"_preLightboxBinds",{}),l()(this,"checkTarget",(function(n){var r=document.getElementById(location.hash.replace(/^#/,""));r&&!r.matches(".".concat(e.LIGHTBOX_CLASS))&&(r=null),t.currentHash=location.hash,r?t.createLightbox(r):t.closeCurrent()})),l()(this,"createLightbox",(function(e){var r;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t._currentLightbox&&t.removeCurrent(),t._dispatchBinding(t._preLightboxBinds),i.prev=2,i.next=5,a.a.awrap(n.e(29).then(n.bind(null,"roNN")));case 5:r=i.sent.default,document.body.classList.remove("js-no-lightbox"),t._currentNode=e,t._currentNodePlaceHolder=document.createElement("span"),t._currentNodePlaceHolder.setAttribute("data-lightbox-placeholder",""),t._currentNode.parentElement.insertBefore(t._currentNodePlaceHolder,t._currentNode),t._currentLightbox=new r({node:e}),t._currentLightbox.addListener("onClosed",t._onClosed),t._dispatchBinding(t._lightboxBinds),t._currentLightbox.mount(),i.next=22;break;case 17:i.prev=17,i.t0=i.catch(2),console.error(i.t0),document.body.classList.add("js-no-lightbox"),e.scrollIntoView();case 22:case"end":return i.stop()}}),null,null,[[2,17]])})),l()(this,"_onClosed",(function(){t.removeCurrent(),location.hash&&location.hash===t.currentHash&&(window.history&&"function"==typeof window.history.pushState?window.history.pushState(void 0,void 0,"#"):location.hash="")})),window.addEventListener("hashchange",this.checkTarget),"interactive"===document.readyState)this.checkTarget();else{document.addEventListener("readystatechange",(function e(){"interactive"===document.readyState&&(t.checkTarget(),document.removeEventListener("readystatechange",e))}))}}return c()(e,[{key:"closeCurrent",value:function(){this._currentLightbox&&this._currentLightbox.close()}},{key:"removeCurrent",value:function(){this._currentNodePlaceHolder.parentElement.insertBefore(this._currentNode,this._currentNodePlaceHolder),this._currentNodePlaceHolder.remove(),this._currentLightbox.unmount(),this._currentLightbox=null,this._currentNode=null,this._currentNodePlaceHolder=null}},{key:"_addBinding",value:function(e,t,n){return n[e]||(n[e]=new Set),n[e].add(t),e===this.currentHash&&t(this._currentLightbox),this}},{key:"_removeBinding",value:function(e,t,n){var r=n[e];return r&&(r.delete(t),r.size||delete n[e]),this}},{key:"_dispatchBinding",value:function(e){var t=e[this.currentHash];if(t){var n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(this._currentLightbox)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}},{key:"removeBind",value:function(e,t){return this._removeBinding(e,t,this._lightboxBinds)}},{key:"bindToLightbox",value:function(e,t){return this._addBinding(e,t,this._lightboxBinds)}},{key:"addPreLightboxBind",value:function(e,t){return this._removeBinding(e,t,this._preLightboxBinds)}},{key:"addPreLightboxBind",value:function(e,t){return this._addBinding(e,t,this._preLightboxBinds)}}]),e}();l()(d,"LIGHTBOX_CLASS","js-lightbox"),t.a=new d},X1WJ:function(e,t,n){"use strict";var r=n("5v7H"),a=n("7iNS"),i=n("+qE3"),o=function(){};o.extend=function(e){return Object(r.a)({},{_events:{UPDATE:"UPDATE"},_emitter:new i.EventEmitter,_data:{},_lockDataKeys:!0,getData:function(){return Object(r.a)({},this._data)},bind:function(e){return this._emitter.on(this._events.UPDATE,e),this},unbind:function(e){return this._emitter.removeListener(this._events.UPDATE,e),this},setData:function(e){return Object.keys(e).forEach((function(t){(!this._validate(t,e[t])||this._lockDataKeys&&!this._data.hasOwnProperty(t))&&delete e[t]}),this),this._data=Object(r.a)(this._data,e),this._update(),this},_update:Object(a.a)((function(){this._emitter.emit(this._events.UPDATE)}),10),_validate:function(e,t){return!0}},{_emitter:new i.EventEmitter},e)},t.a=o},XMGv:function(e,t,n){"use strict";var r=n("lwsE"),a=n.n(r),i=n("W8MJ"),o=n.n(i),s=n("lSNA"),c=n.n(s);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;a()(this,e),c()(this,"_timeout",null),c()(this,"_state",{width:null,height:null,breakpoint:null,isMobile:null}),c()(this,"_listeners",new Set),c()(this,"_onResize",(function(e){t._clearTimeout(),t._timeout=setTimeout((function(){t._clearTimeout(),t._dispatchResizeEnd(e)}),t.wait)})),this.window=n,this.wait=r,this._updateState(),this.attachWindowListener()}return o()(e,[{key:"isMobile",value:function(){return this._state.isMobile}},{key:"getState",value:function(){return l({},this._state)}},{key:"_updateState",value:function(){var t=window.innerWidth,n=window.innerHeight,r=e.BREAKPOINTS[e.BREAKPOINTS.length-1],a=!0,i=!1,o=void 0;try{for(var s,c=e.BREAKPOINTS[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var u=s.value;t>u&&(r=u)}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}var l=t<=e.MOBILE_BREAK;return this._state={width:t,height:n,breakpoint:r,isMobile:l}}},{key:"addListener",value:function(e){return this._listeners.add(e),this}},{key:"removeListener",value:function(e){return this._listeners.delete(e),this}},{key:"attachWindowListener",value:function(){return this.window.addEventListener("resize",this._onResize),this}},{key:"removeWindowListener",value:function(){return this.window.removeEventListener("resize",this._onResize),this}},{key:"_clearTimeout",value:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}},{key:"_dispatchResizeEnd",value:function(t){var n=this._state,r=this._updateState();if(n.width!==r.width||n.height!==r.height){var a=!0,i=!1,o=void 0;try{for(var s,c=this._listeners[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){s.value.call(this,l({type:e.EVENT,originalEvent:t,lastState:l({},n)},r))}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}}}}]),e}();c()(d,"MOBILE_BREAK",785),c()(d,"BREAKPOINTS",[320,480,550,650,720,784,790,1e3,1190]),c()(d,"EVENT","resizeEnd"),t.a=new d},Z3Ny:function(e,t,n){"use strict";t.a=function(e){var t=0,n={},r={};return(e||r.logToConsole)&&(r._getBinds=function(){return n}),r.bind=function(e,r,a){if("string"!=typeof e&&"function"!=typeof r)return!1;n[e]||(n[e]={});var i=++t;return n[e][i]={func:r,context:a||window},i.toString()},r.unbind=function(e){var t;if(!e)return!1;for(t in n)if(n[t][e])return delete n[t][e],!0;return!1},r.once=function(e,t,n){var a=r.bind(e,(function(){r.unbind(a);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];t.call.apply(t,[n].concat(i))}));return a},r.announce=function(t,a){var i;if(void 0===t)throw new Error("Argument `event` is required");if((e||r.logToConsole)&&console.log("%cEvent Announcement :: %c%s :","color:#3c592e;","color:#000;",t,a),n[t])for(i in n[t])"function"==typeof n[t][i].func&&n[t][i].func.call(n[t][i].context,a,t)},r.dispatch=r.announce,r}},mmso:function(e,t,n){"use strict";var r=n("X1WJ"),a=n("uqmy"),i=n("vByC"),o=r.a.extend({_data:{isbn13:null,alternatives:null}});a.a.bind(i.a.UPDATE,(function(e){o.setData(e)})),t.a=o},r6zU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r={DOM_CONTENT_LOADED:"DOM_CONTENT_LOADED",DOM_CONTENT_WILL_UNLOAD:"DOM_CONTENT_WILL_UNLOAD"},a={FIELD_NAME:"cTrk",DATA_ATTR:"data-ctrk",QueryTemplate:{STRING:"?cTrk={{cTrk}}",MATCH:/\{\{cTrk\}\}/}};t.c={Actions:r,Events:{ON_RESIZE_END:"ON_RESIZE_END"},ClickTracking:a}},uaZG:function(e,t,n){"use strict";function r(e,t){return e.matches(t)?e:e.parentElement?r(e.parentElement,t):null}n.d(t,"a",(function(){return r}))},uqmy:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=new(n("Z3Ny").a),a=!1;function i(){return a}r.setAppStarted=function(){a=!0},r.isAppStarted=i,t.a=r},vByC:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={UPDATE:"bkpg:update"};t.b={Actions:r,Routes:{ALT_FORMATS:"/book/alternatives"}}}},[["HTjc",0,2,3,4,58]]]);
//# sourceMappingURL=book-new-layout~b1aa8771-41d0565ded85080c5c89.js.map